#
# AUTO GENERATED - MARKED REGIONS WILL BE KEPT
# template version 2
#

# module setup:
# - ${MODULE_NAME}: module name
cpp_module_setup()

# ev@bcc62523-e22b-41d7-ba2f-825b493a3c97:v1
# insert your custom targets and additional config variables here
find_package(OpenSSL REQUIRED)
list(APPEND ADDITIONAL_MODULE_LIBS
    ocpp
    date::date
    date::date-tz
    OpenSSL::SSL
    OpenSSL::Crypto
)

# ev@bcc62523-e22b-41d7-ba2f-825b493a3c97:v1
target_include_directories(${MODULE_NAME}
    PRIVATE
    ${CMAKE_CURRENT_SOURCE_DIR}
    ${GENERATED_HEADER_DIR}
    ${MODULE_LOADER_DIR}
    ${ADDITIONAL_MODULE_INCLUDES}
)

target_sources(${MODULE_NAME}
    PRIVATE
    ${MODULE_NAME}.cpp
    "${MODULE_LOADER_DIR}/ld-ev.cpp"
    "main/ocpp_1_6_charge_pointImpl.cpp"
    "auth_validator/auth_token_validatorImpl.cpp"
    "auth_provider/auth_token_providerImpl.cpp"
    ${ADDITIONAL_MODULE_SOURCES}
)

target_link_libraries(${MODULE_NAME}
    PRIVATE
    everest ${CMAKE_DL_LIBS}
    everest::log
    Boost::thread
    Boost::program_options
    fmt::fmt
    mqttc
    nlohmann_json::nlohmann_json
    ${ADDITIONAL_MODULE_LIBS}
)

target_compile_features(${MODULE_NAME} PRIVATE cxx_std_14)

set(OCPP_DEST "modules/${MODULE_NAME}")

install(TARGETS ${MODULE_NAME}
    DESTINATION ${OCPP_DEST}
)

install(FILES manifest.json
    DESTINATION ${OCPP_DEST}
)

# ev@c55432ab-152c-45a9-9d2e-7281d50c69c3:v1
# insert other things like install cmds etc here
install(PROGRAMS constants.env diagnostics_uploader.sh firmware_updater.sh signed_firmware_downloader.sh signed_firmware_installer.sh
    DESTINATION bin
)

# ev@c55432ab-152c-45a9-9d2e-7281d50c69c3:v1
